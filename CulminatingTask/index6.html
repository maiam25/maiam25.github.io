<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ski Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(180deg, #1e3c72 0%, #2a5298 50%, #87ceeb 100%);
            font-family: 'Arial', sans-serif;
        }
        
        #gameContainer {
            position: relative;
        }
        
        canvas {
            display: block;
            border: 4px solid #fff;
            border-radius: 8px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            background: linear-gradient(180deg, #ffffff 0%, #f0f8ff 100%);
        }
        
        .screen {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 50px 60px;
            border-radius: 20px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.4);
            text-align: center;
            z-index: 100;
        }
        
        .screen h1 {
            color: #fff;
            font-size: 56px;
            margin-bottom: 30px;
            text-shadow: 2px 2px 10px rgba(0,0,0,0.3);
            letter-spacing: 2px;
        }
        
        .screen h2 {
            color: #fff;
            font-size: 32px;
            margin-bottom: 20px;
            text-shadow: 2px 2px 10px rgba(0,0,0,0.3);
        }
        
        .btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border: none;
            padding: 18px 45px;
            font-size: 24px;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(245, 87, 108, 0.4);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 10px;
            display: inline-block;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(245, 87, 108, 0.6);
        }
        
        .btn:active {
            transform: translateY(-1px);
        }
        
        .btn.easy {
            background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);
            box-shadow: 0 5px 20px rgba(132, 250, 176, 0.4);
        }
        
        .btn.easy:hover {
            box-shadow: 0 8px 30px rgba(132, 250, 176, 0.6);
        }
        
        .btn.medium {
            background: linear-gradient(135deg, #ffa751 0%, #ffe259 100%);
            box-shadow: 0 5px 20px rgba(255, 167, 81, 0.4);
        }
        
        .btn.medium:hover {
            box-shadow: 0 8px 30px rgba(255, 167, 81, 0.6);
        }
        
        .btn.hard {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            box-shadow: 0 5px 20px rgba(255, 107, 107, 0.4);
        }
        
        .btn.hard:hover {
            box-shadow: 0 8px 30px rgba(255, 107, 107, 0.6);
        }
        
        .btn.small {
            padding: 15px 35px;
            font-size: 20px;
        }
    
        .image-button {
            background: none;
            border: none;
            padding: 0;
            cursor: pointer;
            margin: 10px;
            transition: transform 0.2s ease;
        }
        
        .image-button:hover img {
            content: url("restart2.png");
            width: 250px;
            height: 120px;
            transform: scale(1.05);
        }

        .image-button img {
    width: 250px;
    height: 120px;
    object-fit: contain;
    transition: transform 0.2s ease;
    background: none;
    border: none;
}

        .highscore-text {
            color: #fff;
            font-size: 20px;
            font-weight: bold;
            text-shadow: 1px 1px 5px rgba(0,0,0,0.3);
            margin-left: 15px;
            display: inline-block;
            vertical-align: middle;
        }
        
        .highscore-text span {
            color: #FFD700;
            font-size: 22px;
        }
        
        #stats {
            background: rgba(255, 255, 255, 0.95);
            padding: 15px 30px;
            border-radius: 10px;
            margin-bottom: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }
        
        #stats div {
            font-size: 22px;
            font-weight: bold;
            color: #333;
        }
        
        #stats span {
            color: #667eea;
            font-size: 24px;
        }
        
        .hidden {
            display: none;
        }
        
        #gameOverScreen p {
            color: #fff;
            font-size: 28px;
            margin: 20px 0;
            text-shadow: 1px 1px 5px rgba(0,0,0,0.3);
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <!-- Main Menu -->
        <div id="mainMenu" class="screen">
            <h1>⛷️ SKI GAME ⛷️</h1>
            <button class="btn" onclick="showFreeSkiMenu()">Free Ski</button>
            <button class="btn" onclick="showRaceMenu()">Race</button>
        </div>
        
        <!-- Free Ski Menu -->
        <div id="freeSkiMenu" class="screen hidden">
            <h1>Free Ski</h1>
            <h2>Choose Difficulty</h2>
            <div style="margin: 10px 0;">
                <button class="btn easy" onclick="startFreeSki('easy')">Easy</button>
                <span class="highscore-text">Best: <span id="highscoreEasy">0</span>m</span>
            </div>
            <div style="margin: 10px 0;">
                <button class="btn medium" onclick="startFreeSki('medium')">Medium</button>
                <span class="highscore-text">Best: <span id="highscoreMedium">0</span>m</span>
            </div>
            <div style="margin: 10px 0;">
                <button class="btn hard" onclick="startFreeSki('hard')">Hard</button>
                <span class="highscore-text">Best: <span id="highscoreHard">0</span>m</span>
            </div>
            <button class="btn small" onclick="backToMain()">Back</button>
        </div>
        
        <!-- Race Menu -->
        <div id="raceMenu" class="screen hidden">
            <h1>Race Mode</h1>
            <h2>Choose Race Type</h2>
            <button class="btn" onclick="startRace('gs')">Giant Slalom (GS)</button>
            <button class="btn" onclick="startRace('slalom')">Slalom</button>
            <button class="btn small" onclick="backToMain()">Back</button>
        </div>
        
        <!-- Game Over Screen -->
        <div id="gameOverScreen" class="screen hidden">
            <h1>Game Over!</h1>
            <p id="gameOverMessage"></p>
        <!--<button class="btn small" onclick="playAgain()">Play Again</button>-->
            <button class="image-button" onclick="playAgain()"><img src="restart1.png" width="250" height="120"></button>

            <button class="btn small" onclick="returnHome()">Home</button>
        </div>
        
        <div id="stats" class="hidden">
            <div id="statsContent"></div>
        </div>
        <canvas id="game" width="500" height="700"></canvas>
    </div>

    <script>
        const canvas = document.getElementById('game');
        const ctx = canvas.getContext('2d');
        
        let gameMode = null;
        let raceType = null;
        let difficulty = null;
        let skier = { x: 250, y: 120, w: 70, h: 85, speed: 7 };
        let trees = [];
        let coins = [];
        let gates = [];
        let distance = 0;
        let coinCount = 0;
        let time = 0;
        let gameActive = false;
        let keys = {};
        let scrollSpeed = 5;
        let frame = 0;
        let gatesPassed = 0;
        
        // Image loading
        const treeImg = new Image();
        let useTreeImage = false;
        treeImg.onload = function() {
            useTreeImage = true;
        };
        treeImg.onerror = function() {
            useTreeImage = false;
        };
        treeImg.src = "tree.png"; // Replace with your tree image path
        
        const skierImg = new Image();
        let useSkierImage = false;
        skierImg.onload = function() {
            useSkierImage = true;
        };
        skierImg.onerror = function() {
            useSkierImage = false;
        };
        skierImg.src = "skier.png"; // Replace with your skier image path
        
        let highscores = {
            easy: 0,
            medium: 0,
            hard: 0
        };
        
        if (localStorage.getItem('skiGameHighscores')) {
            highscores = JSON.parse(localStorage.getItem('skiGameHighscores'));
            document.getElementById('highscoreEasy').textContent = highscores.easy;
            document.getElementById('highscoreMedium').textContent = highscores.medium;
            document.getElementById('highscoreHard').textContent = highscores.hard;
        }
        
        const difficulties = {
            easy: { baseSpeed: 5, speedIncrease: 0.015, treeChance: 0.035, coinChance: 0.025 },
            medium: { baseSpeed: 5, speedIncrease: 0.015, treeChance: 0.035, coinChance: 0.025 },
            hard: { baseSpeed: 5, speedIncrease: 0.015, treeChance: 0.035, coinChance: 0.025 }
        };
        
        const raceSettings = {
            gs: { gateWidth: 150, gateSpacing: 250, offset: 80, speed: 7, treeChance: 0.02 },
            slalom: { gateWidth: 100, gateSpacing: 150, offset: 120, speed: 6, treeChance: 0.015 }
        };
        
        document.addEventListener('keydown', (e) => { keys[e.key] = true; });
        document.addEventListener('keyup', (e) => { keys[e.key] = false; });
        
        function showFreeSkiMenu() {
            document.getElementById('mainMenu').classList.add('hidden');
            document.getElementById('freeSkiMenu').classList.remove('hidden');
        }
        
        function showRaceMenu() {
            document.getElementById('mainMenu').classList.add('hidden');
            document.getElementById('raceMenu').classList.remove('hidden');
        }
        
        function backToMain() {
            document.getElementById('freeSkiMenu').classList.add('hidden');
            document.getElementById('raceMenu').classList.add('hidden');
            document.getElementById('mainMenu').classList.remove('hidden');
        }
        
        function startFreeSki(diff) {
            gameMode = 'freeski';
            difficulty = diff;
            document.getElementById('freeSkiMenu').classList.add('hidden');
            initGame();
        }
        
        function startRace(type) {
            gameMode = 'race';
            raceType = type;
            document.getElementById('raceMenu').classList.add('hidden');
            initGame();
        }
        
        function initGame() {
            skier = { x: 250, y: 120, w: 70, h: 85, speed: 7 };
            trees = [];
            coins = [];
            gates = [];
            distance = 0;
            coinCount = 0;
            time = 0;
            gameActive = true;
            frame = 0;
            gatesPassed = 0;
            
            if (gameMode === 'freeski') {
                scrollSpeed = 5;
            } else {
                scrollSpeed = raceSettings[raceType].speed;
            }
            
            document.getElementById('gameOverScreen').classList.add('hidden');
            document.getElementById('stats').classList.remove('hidden');
            
            gameLoop();
        }
        
        function endGame(message) {
            gameActive = false;
            
            if (gameMode === 'freeski') {
                const finalDistance = Math.floor(distance);
                document.getElementById('gameOverMessage').innerHTML = 
                    `Distance: ${finalDistance}m<br>Coins: ${coinCount}`;
                
                if (finalDistance > highscores[difficulty]) {
                    highscores[difficulty] = finalDistance;
                    localStorage.setItem('skiGameHighscores', JSON.stringify(highscores));
                    document.getElementById('highscore' + difficulty.charAt(0).toUpperCase() + difficulty.slice(1)).textContent = finalDistance;
                }
            } else {
                document.getElementById('gameOverMessage').innerHTML = message;
            }
            
            document.getElementById('gameOverScreen').classList.remove('hidden');
            document.getElementById('stats').classList.add('hidden');
        }
        
        function playAgain() {
            if (gameMode === 'freeski') {
                startFreeSki(difficulty);
            } else {
                startRace(raceType);
            }
        }
        
        function returnHome() {
            document.getElementById('gameOverScreen').classList.add('hidden');
            document.getElementById('mainMenu').classList.remove('hidden');
        }
        
        function createTree() {
            const x = Math.random() * (canvas.width - 100) + 50;
            trees.push({ x: x, y: canvas.height + 120, w: 90, h: 110 });
        }
        
        function createCoin() {
            const x = Math.random() * (canvas.width - 30) + 15;
            coins.push({ x: x, y: canvas.height + 25, w: 22, h: 22 });
        }
        
        function createGate() {
            const settings = raceSettings[raceType];
            const side = gates.length % 2 === 0 ? -1 : 1;
            const centerX = canvas.width / 2 + (side * settings.offset);
            
            gates.push({
                x: centerX,
                y: canvas.height + 50,
                w: settings.gateWidth,
                passed: false,
                side: side
            });
        }
        
        function updateGame() {
            if (!gameActive) return;
            
            frame++;
            
            if (gameMode === 'freeski') {
                scrollSpeed = 5 + (distance * 0.015);
            }
            
            if (keys['ArrowLeft'] && skier.x > 0) {
                skier.x -= skier.speed;
            }
            if (keys['ArrowRight'] && skier.x < canvas.width - skier.w) {
                skier.x += skier.speed;
            }
            
            distance += scrollSpeed * 0.1;
            time += 1/60;
            
            // Update trees
            for (let i = trees.length - 1; i >= 0; i--) {
                trees[i].y -= scrollSpeed;
                
                if (trees[i].y < -120) {
                    trees.splice(i, 1);
                    continue;
                }
                
                if (skier.x < trees[i].x + trees[i].w - 25 &&
                    skier.x + skier.w > trees[i].x + 25 &&
                    skier.y < trees[i].y + trees[i].h - 25 &&
                    skier.y + skier.h > trees[i].y + 25) {
                    endGame(gameMode === 'freeski' ? 'Hit a tree!' : `Hit a tree!<br>Gates: ${gatesPassed}/20`);
                    return;
                }
            }
            
            // Free Ski Mode
            if (gameMode === 'freeski') {
                for (let i = coins.length - 1; i >= 0; i--) {
                    coins[i].y -= scrollSpeed;
                    
                    if (coins[i].y < -25) {
                        coins.splice(i, 1);
                        continue;
                    }
                    
                    if (skier.x < coins[i].x + coins[i].w &&
                        skier.x + skier.w > coins[i].x &&
                        skier.y < coins[i].y + coins[i].h &&
                        skier.y + skier.h > coins[i].y) {
                        coins.splice(i, 1);
                        coinCount++;
                    }
                }
                
                if (Math.random() < 0.035 + scrollSpeed * 0.002) createTree();
                if (Math.random() < 0.025) createCoin();
            }
            
            // Race Mode
            if (gameMode === 'race') {
                // Spawn trees in race mode
                if (Math.random() < raceSettings[raceType].treeChance) {
                    ;
                }
                
                for (let i = gates.length - 1; i >= 0; i--) {
                    gates[i].y -= scrollSpeed;
                    
                    if (gates[i].y < -50 && !gates[i].passed) {
                        endGame(`Missed Gate ${gatesPassed + 1}!<br>Time: ${time.toFixed(2)}s`);
                        return;
                    }
                    
                    if (!gates[i].passed && 
                        skier.y < gates[i].y + 50 && 
                        skier.y + skier.h > gates[i].y) {
                        
                        const skierCenter = skier.x + skier.w / 2;
                        const gateLeft = gates[i].x - gates[i].w / 2;
                        const gateRight = gates[i].x + gates[i].w / 2;
                        
                        if (skierCenter >= gateLeft && skierCenter <= gateRight) {
                            gates[i].passed = true;
                            gatesPassed++;
                            
                            if (gatesPassed >= 20) {
                                endGame(`Race Complete!<br>Time: ${time.toFixed(2)}s<br>Great job!`);
                                return;
                            }
                        }
                    }
                    
                    if (gates[i].y < -100) {
                        gates.splice(i, 1);
                    }
                }
                
                if (gates.length < 5 && gatesPassed < 20) {
                    if (gates.length === 0 || canvas.height - gates[gates.length - 1].y > raceSettings[raceType].gateSpacing) {
                        createGate();
                    }
                }
            }
        }
        
        function drawGame() {
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 3;
            for (let i = 0; i < 6; i++) {
                let offset = (frame * scrollSpeed * 0.5) % 120;
                ctx.beginPath();
                ctx.moveTo(60 + i * 90, canvas.height + offset);
                ctx.lineTo(60 + i * 90, 0);
                ctx.stroke();
            }
            
            // Draw skier
            if (useSkierImage && skierImg.complete) {
                ctx.drawImage(skierImg, skier.x, skier.y, skier.w, skier.h);
            } else {
                ctx.fillStyle = '#ff3333';
                ctx.strokeStyle = '#cc0000';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(skier.x + skier.w / 2, skier.y + skier.h);
                ctx.lineTo(skier.x, skier.y);
                ctx.lineTo(skier.x + skier.w, skier.y);
                ctx.closePath();
                ctx.fill();
                ctx.stroke();
            }
            
            // Draw trees
            if (gameMode === 'freeski') {
            for (let tree of trees) {
                if (useTreeImage && treeImg.complete) {
                    ctx.drawImage(treeImg, tree.x, tree.y, tree.w, tree.h);
                } else {
                    ctx.fillStyle = '#0d4d4d';
                    ctx.beginPath();
                    ctx.moveTo(tree.x + tree.w / 2, tree.y);
                    ctx.lineTo(tree.x, tree.y + tree.h * 0.7);
                    ctx.lineTo(tree.x + tree.w, tree.y + tree.h * 0.7);
                    ctx.closePath();
                    ctx.fill();
                    
                    ctx.fillStyle = '#b8d8e8';
                    ctx.beginPath();
                    ctx.moveTo(tree.x + tree.w / 2, tree.y + 5);
                    ctx.lineTo(tree.x + 10, tree.y + tree.h * 0.5);
                    ctx.lineTo(tree.x + tree.w - 10, tree.y + tree.h * 0.5);
                    ctx.closePath();
                    ctx.fill();
                    
                    ctx.fillStyle = '#6b4423';
                    ctx.fillRect(tree.x + tree.w / 2 - 8, tree.y + tree.h * 0.7, 16, tree.h * 0.3);
                }
            }
        }
            
            // Draw coins (Free Ski only)
            if (gameMode === 'freeski') {
                ctx.fillStyle = '#FFD700';
                ctx.strokeStyle = '#FFA500';
                ctx.lineWidth = 3;
                for (let coin of coins) {
                    ctx.beginPath();
                    ctx.arc(coin.x + coin.w / 2, coin.y + coin.h / 2, coin.w / 2, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.stroke();
                    
                    ctx.fillStyle = '#FFA500';
                    ctx.font = 'bold 12px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText('$', coin.x + coin.w / 2, coin.y + coin.h / 2 + 4);
                    ctx.fillStyle = '#FFD700';
                }
            }
            
            // Draw gates (Race only)
            if (gameMode === 'race') {
                for (let gate of gates) {
                    const leftPole = gate.x - gate.w / 2;
                    const rightPole = gate.x + gate.w / 2;
                    const color = gate.passed ? '#00ff00' : (gate.side === -1 ? '#ff0000' : '#0000ff');
                    
                    ctx.fillStyle = color;
                    ctx.fillRect(leftPole - 5, gate.y, 10, 50);
                    ctx.beginPath();
                    ctx.arc(leftPole, gate.y, 15, 0, Math.PI * 2);
                    ctx.fill();
                    
                    ctx.fillRect(rightPole - 5, gate.y, 10, 50);
                    ctx.beginPath();
                    ctx.arc(rightPole, gate.y, 15, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
            
            // Update stats
            if (gameMode === 'freeski') {
                document.getElementById('statsContent').innerHTML = 
                    `Distance: <span>${Math.floor(distance)}</span>m | Coins: <span>${coinCount}</span> | Speed: <span>${Math.floor(scrollSpeed)}</span>`;
            } else {
                document.getElementById('statsContent').innerHTML = 
                    `Time: <span>${time.toFixed(2)}</span>s | Gates: <span>${gatesPassed}</span>/20 | Speed: <span>${Math.floor(scrollSpeed)}</span>`;
            }
        }
        
        function gameLoop() {
            updateGame();
            drawGame();
            if (gameActive) {
                requestAnimationFrame(gameLoop);
            }
        }
    </script>
</body>
</html>